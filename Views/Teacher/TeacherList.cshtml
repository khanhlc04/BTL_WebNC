@model IEnumerable<BTL_WebNC.Models.Teacher.TeacherModel>
@using System.Security.Claims

@{
    ViewData["Title"] = "Danh sách giảng viên";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var currentSort = ViewData["CurrentSort"] as string ?? string.Empty;
    var userEmail = User.FindFirst(ClaimTypes.Email)?.Value ?? string.Empty;
    var isStudent = userEmail.EndsWith("@students.hou.edu.vn");
}

<style>
    .teacher-grid { display:flex; flex-wrap:wrap; gap:16px; }
    .teacher-card { background:#fff; border-radius:8px; padding:12px; box-shadow:0 2px 8px rgba(0,0,0,0.06); flex:1 1 calc(25% - 16px); min-width:220px; position:relative; text-decoration:none; color:inherit; }
    .teacher-card h4 { margin:0 0 8px 0; font-size:16px; }
    .teacher-card p { margin:0; color:#555; font-size:14px; }
    .chat-btn { position:absolute; right:8px; top:8px; }
    @@media (max-width:768px) { .teacher-card { flex:1 1 100%; } }
</style>

<h2>Danh sách giảng viên</h2>

<div class="teacher-grid">
    @if (Model != null)
    {
        foreach (var item in Model)
        {
            <div class="teacher-card">
                @if (isStudent)
                {
                    <a class="btn btn-sm btn-success chat-btn" href="@Url.Action("Index", "Chat", new { recipientId = item.AccountId })">Chat</a>
                }

                <h4><a href="@Url.Action("Details", "Teacher", new { id = item.Id })">@item.FullName</a></h4>
                <p>@(item.Email ?? "-")</p>
                <p style="margin-top:8px; color:#888; font-size:13px;">Môn: 
                    @if (item.TeacherSubjects != null && item.TeacherSubjects.Any())
                    {
                        @string.Join(", ", item.TeacherSubjects.Select(ts => ts.Subject?.Name ?? "N/A"))
                    }
                    else
                    {
                        <span>Chưa đăng ký môn học</span>
                    }
                </p>
            </div>
        }
    }
    else
    {
        <div>Không có giảng viên phù hợp.</div>
    }
</div>